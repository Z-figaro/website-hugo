<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta itemprop="name" content="IPFS基础">
<meta itemprop="description" content="IPFS是什么：

IPFS is a global, versioned, peer-to-peer filesystem. It combines good ideas
from Git, BitTorrent, Kademlia, SFS, and the Web. It is like a single bit-
torrent swarm, exchanging git objects. IPFS provides an interface as simple
as the HTTP web, but with permanence built in. You can also mount the world
at /ipfs.


这是ipfs的原话，我的理解是ipfs是一个去中心化的网络系统。它吸取了git，sfs等8个先进有效的方法来管理整个文件系统。去中心化，靠协议和各种共识机制来约定行为是未来互联网的方向；因为这就和电子商务一样，最核心的是能进一步提高效率，节约大量的成本。所以这是大趋势，不可逆转。">


<meta itemprop="datePublished" content="2018-12-19T15:37:53&#43;08:00" />
<meta itemprop="dateModified" content="2018-12-19T15:37:53&#43;08:00" />
<meta itemprop="wordCount" content="1801">



<meta itemprop="keywords" content="ipfs,blockchain," />
<meta property="og:title" content="IPFS基础" />
<meta property="og:description" content="IPFS是什么：

IPFS is a global, versioned, peer-to-peer filesystem. It combines good ideas
from Git, BitTorrent, Kademlia, SFS, and the Web. It is like a single bit-
torrent swarm, exchanging git objects. IPFS provides an interface as simple
as the HTTP web, but with permanence built in. You can also mount the world
at /ipfs.


这是ipfs的原话，我的理解是ipfs是一个去中心化的网络系统。它吸取了git，sfs等8个先进有效的方法来管理整个文件系统。去中心化，靠协议和各种共识机制来约定行为是未来互联网的方向；因为这就和电子商务一样，最核心的是能进一步提高效率，节约大量的成本。所以这是大趋势，不可逆转。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://z-figaro.github.io/daily/ipfs%E5%9F%BA%E7%A1%80/" />
<meta property="article:published_time" content="2018-12-19T15:37:53&#43;08:00"/>
<meta property="article:modified_time" content="2018-12-19T15:37:53&#43;08:00"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="IPFS基础"/>
<meta name="twitter:description" content="IPFS是什么：

IPFS is a global, versioned, peer-to-peer filesystem. It combines good ideas
from Git, BitTorrent, Kademlia, SFS, and the Web. It is like a single bit-
torrent swarm, exchanging git objects. IPFS provides an interface as simple
as the HTTP web, but with permanence built in. You can also mount the world
at /ipfs.


这是ipfs的原话，我的理解是ipfs是一个去中心化的网络系统。它吸取了git，sfs等8个先进有效的方法来管理整个文件系统。去中心化，靠协议和各种共识机制来约定行为是未来互联网的方向；因为这就和电子商务一样，最核心的是能进一步提高效率，节约大量的成本。所以这是大趋势，不可逆转。"/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>IPFS基础</title>
	<link rel="stylesheet" href="https://z-figaro.github.io/css/style.min.c693329ce3bac2503f88115a4011a284a06d53e30f484562a37664dc4c5f0a74.css" integrity="sha256-xpMynOO6wlA/iBFaQBGihKBtU+MPSEVio3Zk3ExfCnQ=">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://z-figaro.github.io/">Figaro ZP</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="https://z-figaro.github.io/daily/">Daily</a>
					<a href="https://z-figaro.github.io/golang/">Golang</a>
					<a href="https://z-figaro.github.io/python/">Python</a>
					<a href="https://z-figaro.github.io/ios/">iOS</a>
					<a href="https://z-figaro.github.io/about-me/">About</a>
				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://www.facebook.com/zp.figaro.5" target="_blank" rel="noopener" title="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-facebook"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a><a href="zpfigaro@gmail.com" target="_blank" rel="noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a><a href="https://github.com/Z-figaro" target="_blank" rel="noopener" title="Github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://z-figaro.github.io/daily/">Daily</a></li>
			<li><a href="https://z-figaro.github.io/golang/">Golang</a></li>
			<li><a href="https://z-figaro.github.io/python/">Python</a></li>
			<li><a href="https://z-figaro.github.io/ios/">iOS</a></li>
			<li><a href="https://z-figaro.github.io/about-me/">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner thin animated fadeIn faster">
		<h1>IPFS基础</h1>
		<div class="content">
			<h1 id="ipfs是什么">IPFS是什么：<a href="#ipfs是什么" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>

<pre><code>IPFS is a global, versioned, peer-to-peer filesystem. It combines good ideas
from Git, BitTorrent, Kademlia, SFS, and the Web. It is like a single bit-
torrent swarm, exchanging git objects. IPFS provides an interface as simple
as the HTTP web, but with permanence built in. You can also mount the world
at /ipfs.
</code></pre>

<p>这是ipfs的原话，我的理解是ipfs是一个去中心化的网络系统。它吸取了git，sfs等8个先进有效的方法来管理整个文件系统。去中心化，靠协议和各种共识机制来约定行为是未来互联网的方向；因为这就和电子商务一样，最核心的是能进一步提高效率，节约大量的成本。所以这是大趋势，不可逆转。</p>

<h2 id="ipfs怎么搭建一个去中心网络">IPFS怎么搭建一个去中心网络<a href="#ipfs怎么搭建一个去中心网络" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>

<p><a href="https://www.jianshu.com/p/48a2739bade2" target="_blank">https://www.jianshu.com/p/48a2739bade2</a>
这里把基本使用说的很详细，我可能会使用一部分，不过我会主要说明技术部分。</p>

<p><img src="https://lh3.googleusercontent.com/-s9WMbI9Lyjo/W3z8v1XUyZI/AAAAAAAAB4w/L9zacPObl94YVE5f3GniydkCbSUohTnUQCHMYCw/I/p2p-ipfs.jpg" alt="p2p-ipfs" /></p>

<h3 id="ipfs是一个p2p网络-先来看看bittorrent的p2p网络是如何工作的">IPFS是一个p2p网络，先来看看BitTorrent的p2p网络是如何工作的？<a href="#ipfs是一个p2p网络-先来看看bittorrent的p2p网络是如何工作的" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>

<p>想要bt下载一个文件，首先你需要一个种子文件torrent，种子文件包含至少一个 Tracker（一台服务器地址）信息和文件的分割记录信息。BT软件解析种子文件torrent，从里面找出来tracker，告诉tracker我要下载这个文件。tracker同时返回给你现在其它正在下载的节点信息，这个时候你的节点就正式加入了p2p下载网络，根据tracker返回的信息直接跟其它节点建立联系，开始数据传输。</p>

<p>这种情况下Tracker成为了沟通p2p网络的关键一环，如果tracker服务器全部关闭的话，p2p网络就被关闭了。</p>

<p>那么是不是说如果没有了Tracker，p2p就不能实现了？显然不是的，后来有了DHT（分布式哈希表），DHT技术的出现使得没有tracker也能进行p2p网络下载，用过电驴的读者应该都不陌生，电驴里面有一个选项，可以允许选择KAD（DHT的一种）网络进行搜索。这样一来p2p网络的适应性更强了，可以大大减轻tracker的负担。</p>

<p>以上就是传统的P2P软件大概工作方式。
IPFS的p2p网络使用的是DHT技术</p>

<h3 id="什么是dht-distributed-hash-tables">什么是DHT ( Distributed Hash Tables ) ?<a href="#什么是dht-distributed-hash-tables" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>

<p>DHT是一个分布式系统, 它提供了一个类似哈希表一样的查询服务: 键值对存储在DHT中, 任何参与的节点都可以有效的检索给定键对应的值. 键值对的映射由网络中所有的节点维护, 每个节点负责一小部分路由和数据存储. 这样即使有节点加入或者离开, 对整个网络的影响都很小, 于是DHT可以扩展到非常庞大的节点(上千万)。</p>

<p>DHT广泛应用于各种点对点系统, 用来存储节点的元数据。比如：BTC系统使用 MainlineDHT来维护节点。</p>

<p>DHT具有以下性质:</p>

<p>离散型(Autonomy and decentralization): 构成系统的节点之间都是对等的, 没有中央控制机制进行协调
伸缩性(Scalability): 不论系统有多少节点, 都要求高效工作
容错性(Fault tolerance): 不断有节点加入和离开, 不会影响整个系统的工作</p>

<h3 id="简单介绍一席跟ipfs有关的三种dht技术">简单介绍一席跟IPFS有关的三种DHT技术<a href="#简单介绍一席跟ipfs有关的三种dht技术" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>

<h4 id="kademlia-dht">Kademlia DHT<a href="#kademlia-dht" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h4>

<p>高效查询：查询的平均复杂度是 log2(n)，例如：10,000,000个节点只需要20次查询
低开销：优化了发往其它节点的控制消息的数量
可以抵御各种攻击
广泛应用于各种点对点系统，包括：Guntella和BitTorrent，可以构建超过2千万个节点的网络</p>

<h4 id="coral-dsht">Coral DSHT<a href="#coral-dsht" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h4>

<p>Coral继承了Kademlia并且做了一些改造 ( 它认为直接在DHT上存储数据是浪费存储和带宽)</p>

<h4 id="s-kademlia-dht">S/Kademlia DHT<a href="#s-kademlia-dht" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h4>

<p>S/Kademlia DHT同样是继承了Kademlia，并且做了一些改进，系统可以防止恶意攻击，例如女巫攻击。</p>

<h3 id="ipfs的路由系统">IPFS的路由系统<a href="#ipfs的路由系统" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>

<p>ipfs系统的节点查找有两个需求：</p>

<p>第一找到其他节点地址
第二找到存储有特定数据的节点</p>

<p>IPFS综合了S/Kademlia 、Coral和Mainline技术（能折腾吧，不过这种对技术的追求精神值得我们给ipfs团队鲜花和鼓掌）。Kademlia协议的工作方式比较复杂, 有兴趣了解的可以单独去查询一下, 本文不在进行更深入的讨论. KAD可以很高效进行路由查询服务。</p>

<p>IPFS DHT的数据存储是根据数据的大小进行的：</p>

<p>小于1KB的数据直接存储到DHT上面
大于1KB的数据在DHT中存储的是节点ID</p>

<h3 id="节点加入">节点加入<a href="#节点加入" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>

<p>IPFS是基于DHT技术的，所以在IPFS网络里面是没有tracker存在的。那么一个新的节点创建后是如何加入网络的呢？</p>

<p>新创建的节点必须知道至少一个已经在网络上的节点地址，连上那个节点，就可以加入网络了，所以ipfs系统提供了bootstrap命令来完成这个工作（通常情况不需要自己来做这样的操作，除非有一些特殊需求，例如：指定自己比较近的启动节点，搭建IPFS私有网络等）</p>

<pre><code>ipfs bootstrap list 列出来启动节点
ipfs bootstrap add [&lt;peer&gt;] 添加启动节点
ipfs bootstrap rm [&lt;peer&gt;] 删除启动节点
</code></pre>
		</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2019 <a href="https://z-figaro.github.io/">Figaro ZP</a> &#183; <a href="https://creativecommons.org/licenses/by-figaro zp" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://z-figaro.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="https://z-figaro.github.io/js/main.min.8f39f24808e9d0a9b02da58c2d2838da859dc0b7bdfadbdb1883aae8b6adacfe.js" integrity="sha256-jznySAjp0KmwLaWMLSg42oWdwLe9+tvbGIOq6LatrP4="></script>

</body>

</html>
